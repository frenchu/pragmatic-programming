<!doctype html><html lang=en><head><title>Samba server setup on Ubuntu · Pragmatic Programming</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Paweł Weselak"><meta name=description content="How to quickly setup Samba server on Ubuntu"><meta name=keywords content="Paweł Weselak,personal blog,senior java developer,senior software engineer"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pawelweselak.com/images/samba.jpg"><meta name=twitter:title content="Samba server setup on Ubuntu"><meta name=twitter:description content="How to quickly setup Samba server on Ubuntu"><meta property="og:title" content="Samba server setup on Ubuntu"><meta property="og:description" content="How to quickly setup Samba server on Ubuntu"><meta property="og:type" content="article"><meta property="og:url" content="https://pawelweselak.com/posts/samba/"><meta property="og:image" content="https://pawelweselak.com/images/samba.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-21T00:00:00+00:00"><meta property="article:modified_time" content="2024-01-23T21:27:50+01:00"><link rel=canonical href=https://pawelweselak.com/posts/samba/><link rel=preload href="https://pawelweselak.com/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=https://pawelweselak.com/css/coder.min.135e22c97ff685fe983fc60048e309ced8f00d8d38f536aa67dba8a13a03dfa4.css integrity="sha256-E14iyX/2hf6YP8YASOMJztjwDY049TaqZ9uooToD36Q=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://pawelweselak.com/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=https://pawelweselak.com/images/favicon.svg sizes=any><link rel=icon type=image/png href=https://pawelweselak.com/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://pawelweselak.com/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=https://pawelweselak.com/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=https://pawelweselak.com/images/apple-touch-icon.png><link rel=manifest href=https://pawelweselak.com/site.webmanifest><link rel=mask-icon href=https://pawelweselak.com/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://pawelweselak.com/>Pragmatic Programming</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://pawelweselak.com/about/>About</a></li><li class=navigation-item><a class=navigation-link href=https://pawelweselak.com/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=https://pawelweselak.com/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=https://pawelweselak.com/categories/>Categories</a></li><li class=navigation-item><a class=navigation-link href=https://pawelweselak.com/tags/>Tags</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://pawelweselak.com/posts/samba/>Samba server setup on Ubuntu</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2024-01-21T00:00:00Z>January 21, 2024</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
3-minute read</span></div><div class=categories><i class="fa fa-folder" aria-hidden=true></i>
<a href=https://pawelweselak.com/categories/tools/>tools</a></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://pawelweselak.com/tags/samba/>samba</a></span>
<span class=separator>•</span>
<span class=tag><a href=https://pawelweselak.com/tags/services/>services</a></span>
<span class=separator>•</span>
<span class=tag><a href=https://pawelweselak.com/tags/networking/>networking</a></span>
<span class=separator>•</span>
<span class=tag><a href=https://pawelweselak.com/tags/admin/>admin</a></span>
<span class=separator>•</span>
<span class=tag><a href=https://pawelweselak.com/tags/ubuntu/>ubuntu</a></span></div></div></header><div class=post-content><p>Carnival is at the height of the season,
so it&rsquo;s a good time to publish the first post in 2024!</p><p>Samba is not only popular dance from Brasil
and music instrument, but also a unix service.</p><p>Typically in a home LAN, you need some interoperability
between your linux and windows machines.
For instance file sharing between home server
and personal computers of the family members.
And one of the simplest solutions for that on Linux is&mldr;
Yes, you nailed it, Samba!</p><p>Samba, according to its manual, is a collection of programs
that implements Sever Message Block (SMB) protocol
also known as Common Internet File System (CIFS).</p><p>In this post I will quickly guide you through Samba suite
installation and configuration on Ubuntu.</p><figure><img src=https://pawelweselak.com/images/samba.jpg alt="Samba - carnival in Brasil"><figcaption><p>Samba</p></figcaption></figure><h2 id=install-samba>Install samba
<a class=heading-link href=#install-samba><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>First, let&rsquo;s install Samba suite.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install samba
</span></span></code></pre></div><h2 id=edit-config>Edit config
<a class=heading-link href=#edit-config><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Before start sharing any files, you may want to explore config options and tweak the service.
Then restart Samaba daemon.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/samba/smb.conf
</span></span><span class=line><span class=cl>sudo service smbd restart
</span></span></code></pre></div><h2 id=configure-samba-account-for-yourself>Configure samba account for yourself
<a class=heading-link href=#configure-samba-account-for-yourself><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>You need to set a separate samba password associated with your linux user.
It can be (and even should be) different from your linux password.</p><p>Next, add your linux user to the Samba user group.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo smbpasswd -a <span class=nv>$USER</span>
</span></span><span class=line><span class=cl>sudo usermod -a -G sambashare <span class=nv>$USER</span>
</span></span></code></pre></div><h2 id=add-accounts-for-others>Add accounts for others
<a class=heading-link href=#add-accounts-for-others><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>If you want to share files with others, configure accounts also for them.
They doesn&rsquo;t use linux and doesn&rsquo;t have own linux username.
Although, to properly configure permissions for the shares, first we need to have a linux account for each user.
And then set up samba passwords and group for the users simirarly to the previous step.
You can lock unix accounts with <code>passwd</code> as a security measure.</p><p>Let&rsquo;s say you exchange documents only with your significant other. Here&rsquo;s the example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo adduser karen -G sambashare
</span></span><span class=line><span class=cl>sudo smbpasswd -a karen
</span></span><span class=line><span class=cl>sudo passwd -l karen
</span></span></code></pre></div><h2 id=configure-shares>Configure shares
<a class=heading-link href=#configure-shares><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>And now the most interesting part. Because of Samba group membership, you can configure shares as a regular user
without sudo. Make sure all users have unix access rights to navigate and read shared files and directories.
It can be easily done by changing group ownership of the files to the <code>sambashare</code>.</p><p>In the example below only current user (you) may access priv share, while docs are shared with karen.
Access is denided for everyone else.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chgrp -R sambashare shares/
</span></span><span class=line><span class=cl>net usershare add priv /shares/Documents/priv <span class=s2>&#34;My Stuff&#34;</span> <span class=nv>$USER</span>:f,everyone:d <span class=nv>guest_ok</span><span class=o>=</span>n
</span></span><span class=line><span class=cl>net usershare add docs /shares/Documents/docs <span class=s2>&#34;Shared Documents&#34;</span> <span class=nv>$USER</span>:f,karen:f,everyone:d <span class=nv>guest_ok</span><span class=o>=</span>n
</span></span></code></pre></div><p>Here&rsquo;s a quick explenation of samba ACLs (access control list). Username and access type are joined with colon
and the list elements are separated with coma. Access type can be:</p><ul><li><code>f</code> for full access</li><li><code>r</code> for read-only</li><li><code>d</code> for denied</li></ul><p>Add guest_ok=n to disable guest access. <code>everyone</code> is a special identifier meaning all samba users.
By default all users have read only access.</p><h2 id=verify-users-and-shares>Verify users and shares
<a class=heading-link href=#verify-users-and-shares><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>You can check samba users and available shares with following commands.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pdbedit -L -v
</span></span><span class=line><span class=cl>net usershare info --long
</span></span></code></pre></div><h2 id=configure-firewall>Configure firewall
<a class=heading-link href=#configure-firewall><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>If you are using ufw and by default you denny all traffic,
don&rsquo;t forget to allow access Samba service from the hosts in your local network.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow from 192.168.10.0/24 to any app samba
</span></span><span class=line><span class=cl>sudo ufw reload
</span></span></code></pre></div><h2 id=other-sharing-options>Other sharing options
<a class=heading-link href=#other-sharing-options><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Samba is not the only one service for file sharing. There are more or less advanced solutions which you can discover,
to name the few:</p><ul><li>NFS</li><li>WebDav</li><li>NextCloud</li></ul></div><footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//pragmatic-programming.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}(),document.addEventListener("themeChanged",function(){document.readyState=="complete"&&DISQUS.reset({reload:!0,config:disqus_config})})</script></footer></article></section></div><footer class=footer><section class=container>©
2010 -
2025
Paweł Weselak
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.
[<a href=https://github.com/frenchu/pragmatic-programming/tree/a5547f0001cb5c274a77898d8327429cb84e7cc6 target=_blank rel=noopener>a5547f0</a>]</section></footer></main><script src=https://pawelweselak.com/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>